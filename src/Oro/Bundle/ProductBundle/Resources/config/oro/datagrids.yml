datagrids:
    products-select-grid-base-without-default-sorting:
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
        options:
            entityHint: oro.product.entity_plural_label
        source:
            type:         orm
            query:
                select:
                    - product.id
                    - product.sku
                    - product.skuUppercase
                    - product.createdAt
                    - product.updatedAt
                    - product.status
                    - product.type
                    - product.newArrival
                    - product.denormalizedDefaultName as productName
                    - product.denormalizedDefaultNameUppercase as productNameUppercase
                    - IDENTITY(product.inventory_status) as inventoryStatusId
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Product', alias: product }
        fields_acl:
            columns:
                sku:
                    data_name: product.sku
                names:
                    data_name: product.names
                    column_name: productName
                status:
                    data_name: product.status
                newArrival:
                    data_name: product.newArrival
                createdAt:
                    data_name: product.createdAt
                updatedAt:
                    data_name: product.updatedAt
                inventory_status:
                    data_name: product.inventory_status
                    column_name: inventoryStatusId
                type:
                    data_name: product.type
        columns:
            sku:
                label:         oro.product.sku.label
            productName:
                label:         oro.product.names.label
            inventoryStatusId:
                label:         oro.product.inventory_status.label
                frontend_type: select
                choices:       "@oro_entity_extend.enum_value_provider->getEnumChoicesByCode('prod_inventory_status')"
                translatable_options: false
            status:
                label:         oro.product.status.label
                frontend_type: select
                choices:       "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
            type:
                label:         oro.product.type.label
                frontend_type: select
                choices:       "@oro_product.provider.product_type_provider->getAvailableProductTypes"
                renderable:    false
            newArrival:
                label:         oro.product.new_arrival.label
                frontend_type: select
                choices:
                    oro.product.new_arrival.no: 0
                    oro.product.new_arrival.yes: 1
                renderable:    false
            createdAt:
                label:         oro.ui.created_at
                frontend_type: datetime
            updatedAt:
                label:         oro.ui.updated_at
                frontend_type: datetime
        properties:
            id: ~
        sorters:
            columns:
                sku:
                    data_name: product.sku
                productName:
                    data_name: productName
                status:
                    data_name: product.status
                type:
                    data_name: product.type
                newArrival:
                    data_name: product.newArrival
                createdAt:
                    data_name: product.createdAt
                updatedAt:
                    data_name: product.updatedAt
        filters:
            columns:
                sku:
                    type:      string
                    data_name: product.skuUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                productName:
                    type:      string
                    data_name: productNameUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                inventoryStatusId:
                    type:      enum
                    data_name: inventoryStatusId
                    enum_code: prod_inventory_status
                status:
                    data_name: product.status
                    type: choice
                    options:
                        field_options:
                            choices: "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
                type:
                    type: choice
                    data_name: product.type
                    options:
                        field_options:
                            choices: "@oro_product.provider.product_type_provider->getAvailableProductTypes"
                newArrival:
                    type: boolean
                    data_name: product.newArrival
                    options:
                        field_options:
                            choices:
                                oro.product.new_arrival.yes: 1
                                oro.product.new_arrival.no: 2
                    renderable: false
                createdAt:
                    type:      datetime
                    data_name: product.createdAt
                updatedAt:
                    type:      datetime
                    data_name: product.updatedAt

    products-select-grid-base:
        extends: products-select-grid-base-without-default-sorting
        sorters:
            default:
                createdAt: DESC

    all-products-select-grid:
        extends: products-select-grid-base

    products-select-grid:
        extends: products-select-grid-base
        source:
            query:
                where:
                    and:
                        - product.type IN (:types)
            bind_parameters:
                types:
                    default: ['simple']
        filters:
            columns:
                type:
                    visible: false

    products-select-grid-frontend:
        acl_resource: oro_product_frontend_view
        options:
            entityHint: oro.product.entity_plural_label
            frontend: true
        source:
            type: search
            search_index: website
            skip_acl_apply: true
            query:
                select:
                    - integer.system_entity_id as autocomplete_record_id
                    - text.sku as sku
                    - text.names_LOCALIZATION_ID as productName
                    - text.status as status
                    - text.type as type
                    - datetime.created_at as createdAt
                    - datetime.updated_at as updatedAt
                    - text.inv_status as inventoryStatus
                from:
                    - oro_product_WEBSITE_ID
        columns:
            sku:
                label:         oro.product.sku.label
            productName:
                label:         oro.product.names.label
            inventoryStatus:
                label:         oro.product.inventory_status.label
                frontend_type: select
                choices:       "@oro_entity_extend.enum_value_provider->getEnumChoicesByCode('prod_inventory_status')"
                translatable_options: false
        filters:
            columns:
                sku:
                    type:      string
                    data_name: sku
                productName:
                    type:      string
                    data_name: names_LOCALIZATION_ID
                inventoryStatus:
                    type:      enum
                    data_name: inv_status
                    enum_code: prod_inventory_status
        properties:
            id: ~
        sorters:
            columns:
                sku:
                    data_name: sku
                productName:
                    data_name: names_LOCALIZATION_ID
                inventoryStatus:
                    data_name: inventory_status

            toolbar_sorting: true
            disable_default_sorting: true

    product-collection-base-grid:
        extends: products-select-grid-base-without-default-sorting
        columns:
            type:
                renderable: true
            createdAt:
                renderable: false
            updatedAt:
                renderable: false
        options:
            routerEnabled: false

    product-collection-grid:
        extends: product-collection-base-grid
        options:
            toolbarOptions:
                pageSize:
                    default_per_page: 10
        actions:
            add_to_excluded:
                type:          trigger-event
                event_name:    product-collection-add-to-excluded
                label:         oro.product.grid.action.product_collection.add_to_exclude
                icon:          remove
        mass_actions:
            add_to_excluded:
                type:            trigger-event-for-selected-product-ids
                label:           oro.product.grid.action.product_collection.add_to_exclude
                icon:            remove
                data_identifier: product.id
                event_name:      product-collection-add-to-excluded
        sorters:
            default:
                createdAt: DESC

    product-collection-content-variant-grid:
        extends: product-collection-base-grid
        options:
            requestMethod: POST
            jsmodules:
                - oroproduct/js/datagrid/builder/sort-order-builder
            cellSelection:
                dataField: id
                columnName:
                    - categorySortOrder
            toolbarOptions:
                pageSize:
                    default_per_page: 10
        columns:
            categorySortOrder:
                order: -1
                label: oro.catalog.product.category_sort_order.label
                editable: true
                cellClassName: 'editing-cell'
                frontend_type: string # can't use decimal because of inappropriate formatter
        sorters:
            columns:
                categorySortOrder:
                    data_name: categorySortOrder
            default:
                categorySortOrder: ASC
        filters:
            columns:
                categorySortOrder:
                    type: number-range
                    data_name: categorySortOrder
        actions:
            add_to_excluded:
                type:          trigger-event
                event_name:    product-collection-add-to-excluded
                label:         oro.product.grid.action.product_collection.add_to_exclude
                icon:          remove
        mass_actions:
            add_to_excluded:
                type:            trigger-event-for-selected-product-ids
                label:           oro.product.grid.action.product_collection.add_to_exclude
                icon:            remove
                data_identifier: product.id
                event_name:      product-collection-add-to-excluded

    product-collection-selected-products-grid:
        extends: product-collection-base-grid
        options:
            toolbarOptions:
                pageSize:
                    default_per_page: 10
        source:
            query:
                where:
                    and:
                        - product.id IN (:selectedProducts)
            bind_parameters:
                selectedProducts:
                    default: 0

    product-collection-add-products-base-grid:
        extends: product-collection-base-grid
        options:
            toolbarOptions:
                pageSize:
                    default_per_page: 10
            routerEnabled: false
        source:
            query:
                where:
                    and:
                        - NOT (product.id IN (:hiddenProducts))
            bind_parameters:
                hiddenProducts:
                    default: 0
        sorters:
            default:
                createdAt: DESC
        mass_actions:
            add:
                type: trigger-event-for-selected-product-ids
                label: oro.product.grid.action.product_collection.add_individual_product
                icon: plus
                data_identifier: product.id

    product-collection-add-products-to-included-grid:
        extends: product-collection-add-products-base-grid
        options:
            requestMethod: POST
        mass_actions:
            add:
                event_name: product-collection-add-to-included

    product-collection-add-products-to-excluded-grid:
        extends: product-collection-add-products-base-grid
        options:
            requestMethod: POST
        mass_actions:
            add:
                event_name: product-collection-add-to-excluded

    product-collection-included-products-grid:
        extends: product-collection-selected-products-grid
        options:
            requestMethod: POST
        actions:
            remove_from_included:
                type:          trigger-event
                event_name:    product-collection-remove-from-included
                label:         oro.product.grid.action.product_collection.remove_from_included
                icon:          undo
        mass_actions:
            remove_from_included:
                type:            trigger-event-for-selected-product-ids
                label:           oro.product.grid.action.product_collection.remove_from_included
                icon:            undo
                data_identifier: product.id
                event_name:      product-collection-remove-from-included

    product-collection-excluded-products-grid:
        extends: product-collection-selected-products-grid
        options:
            requestMethod: POST
        actions:
            remove_from_excluded:
                type:          trigger-event
                event_name:    product-collection-remove-from-excluded
                label:         oro.product.grid.action.product_collection.remove_from_excluded
                icon:          trash
        mass_actions:
            remove_from_excluded:
                type:            trigger-event-for-selected-product-ids
                label:           oro.product.grid.action.product_collection.remove_from_excluded
                icon:            trash
                data_identifier: product.id
                event_name:      product-collection-remove-from-excluded

    products-grid:
        extends: products-select-grid-base
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
        options:
            entity_pagination: true
        properties:
            view_link:
                type:  url
                route: oro_product_view
                params:
                    - id
            edit_link:
                type: url
                route: oro_product_update
                params:
                    - id
            delete_link:
                type: url
                route: oro_rest_api_item
                params:
                    - id
                direct_params:
                    entity: 'products'
        actions:
            view:
                type:          navigate
                label:         oro.grid.action.view
                link:          view_link
                icon:          eye
                acl_resource:  oro_product_view
                rowAction:     true
            update:
                type: navigate
                label: oro.grid.action.update
                link: edit_link
                icon: pencil-square-o
                acl_resource: oro_product_update
            delete:
                type: delete
                acl_resource: 'DELETE;entity:Oro\Bundle\ProductBundle\Entity\Product'
                label: oro.grid.action.delete
                icon: trash-o
                link: delete_link
                defaultMessages:
                    confirm_title: oro.product.grid.delete_entity_title
                    confirm_content: oro.action.delete_confirm
                    confirm_content_params:
                        entityLabel: '@translator->trans(oro.product.entity_label)'
                    success: oro.product.grid.delete_success
        mass_actions:
            delete:
                type: delete
                icon: trash
                label: oro.grid.action.delete
                entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
                data_identifier: product.id
                handler: oro_product.datagrid.extension.mass_action.handler.product_delete
        inline_editing:
            enable: true
            behaviour: enable_selected
        fields_acl:
            columns:
                images:
                    data_name: product.images
                    column_name: productImage
        columns:
            productImage:
                label:         oro.product.image.label
                type:          twig
                frontend_type: html
                template:      '@OroProduct/Product/Datagrid/image.html.twig'
                order:         2
            productName:
                inline_editing:
                    enable: true
                    editor:
                        component: oroproduct/js/app/components/product-name-popup-editor-component
                        view_options:
                            value_field_name: names
                    save_api_accessor:
                        route: oro_api_patch_product_inline_edit_name
                        query_parameter_names:
                            - id
                    validation_rules:
                        NotBlank: true
                order:         3
            inventoryStatusId:
                inline_editing:
                    enable: true
                    editor:
                        view_options:
                            value_field_name: inventory_status
                    save_api_accessor:
                        route: oro_api_patch_product_inline_edit_inventory_status
                        query_parameter_names:
                            - id
                    validation_rules:
                        NotBlank: true
                order:         6
            status:
                inline_editing:
                    enable: true
                order:         5
            newArrival:
                inline_editing:
                    enable: true
                order:         7
            createdAt:
                renderable: false
                order:         80
            updatedAt:
                order:         90
        filters:
            columns:
                createdAt:
                    renderable: false

    product-product-variants-base:
        acl_resource: oro_product_view
        options:
            entityHint: oro.product.variant.plural_label
            entity_pagination: true
        source:
            type:         orm
            query:
                select:
                    - product.id
                    - product.sku
                    - product.skuUppercase
                    - product.status
                    - product.denormalizedDefaultName as productName
                    - product.denormalizedDefaultNameUppercase as productNameUppercase
                    - productInventoryStatus.name as inventoryStatusName
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Product', alias: product }
                where:
                    and:
                        - product.id <> :parentProduct
                join:
                    left:
                        - { join: product.inventory_status, alias: productInventoryStatus }
            bind_parameters:
                - parentProduct
        sorters:
            columns:
                id:
                    data_name: product.id
                sku:
                    data_name: product.sku
                productName:
                    data_name: productName
                status:
                    data_name: product.status
        filters:
            columns:
                id:
                    type:      number
                    data_name: product.id
                sku:
                    type:      string
                    data_name: product.skuUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                productName:
                    type:      string
                    data_name: productNameUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                status:
                    data_name: product.status
                    type: choice
                    options:
                        field_options:
                            choices: "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
                inventoryStatusName:
                    label:     oro.product.inventory_status.label
                    type:      enum
                    data_name: inventoryStatusName
                    enum_code: prod_inventory_status

    product-product-variants-edit:
        extends: product-product-variants-base
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
        options:
            rowSelection:
                dataField: id
                columnName: isVariant
                selectors:
                    included: '#productAppendVariants'
                    excluded: '#productRemoveVariants'
        source:
            query:
                select:
                    - >
                         (CASE
                               WHEN (currentVariantLink.id IS NOT NULL OR product.id IN (:data_in)) AND product.id NOT IN (:data_not_in)
                               THEN true
                               ELSE false
                          END) as isVariant
                join:
                    left:
                        -
                            join: 'Oro\Bundle\ProductBundle\Entity\ProductVariantLink'
                            alias: currentVariantLink
                            conditionType: WITH
                            condition: currentVariantLink.product = product.id AND currentVariantLink.parentProduct = :parentProduct
                where:
                    and:
                        - product.type <> :productType
                        - product.attributeFamily = :attributeFamily
            bind_parameters:
                -
                    name: productType
                    default: configurable
                -
                    name: attributeFamily

        columns:
            isVariant:
                label: oro.product.is_variant.label
                editable: true
                frontend_type: boolean
            id:
                label:         oro.product.id.label
            sku:
                label:         oro.product.sku.label
            productName:
                label:         oro.product.names.label
            status:
                label:         oro.product.status.label
                frontend_type: select
                choices:       "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
            inventoryStatus:
                label:         oro.product.inventory_status.label
                type:          twig
                frontend_type: html
                template:      '@OroProduct/Product/Datagrid/inventoryStatus.html.twig'
        sorters:
            columns:
                isVariant:
                    data_name: isVariant
            default:
                sku: ASC

    product-product-variants-view:
        extends: product-product-variants-base
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
        source:
            query:
                select:
                    - productVariantLink.visible as visible
                join:
                    inner:
                        -
                            join: 'Oro\Bundle\ProductBundle\Entity\ProductVariantLink'
                            alias: productVariantLink
                            conditionType: WITH
                            condition: productVariantLink.product = product.id AND productVariantLink.parentProduct = :parentProduct
        columns:
            id:
                label:         oro.product.id.label
            sku:
                label:         oro.product.sku.label
            productName:
                label:         oro.product.names.label
            visible:
                label:         oro.product.productvariantlink.visible.label
                frontend_type: boolean
            status:
                label:         oro.product.status.label
                frontend_type: select
                choices:       "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
            inventoryStatus:
                label:         oro.product.inventory_status.label
                type:          twig
                frontend_type: html
                template:      '@OroProduct/Product/Datagrid/inventoryStatus.html.twig'
        sorters:
            columns:
                visible:
                    data_name: visible
            default:
                visible: DESC
                sku: ASC

    products-related-items-base:
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Product'
        options:
            entityHint: oro.product.entity_plural_label
        source:
            type:         orm
            query:
                select:
                    - product.id
                    - product.sku
                    - product.skuUppercase
                    - product.createdAt
                    - product.updatedAt
                    - product.status
                    - product.type
                    - product.denormalizedDefaultName as productName
                    - product.denormalizedDefaultNameUppercase as productNameUppercase
                    - IDENTITY(product.inventory_status) as inventoryStatusId
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Product', alias: product }
        fields_acl:
            columns:
                names:
                    data_name: product.names
                    column_name: productName
                inventory_status:
                    data_name: product.inventory_status
                    column_name: inventoryStatusId
                sku:
                    data_name: product.sku
                status:
                    data_name: product.status
                newArrival:
                    data_name: product.newArrival
                createdAt:
                    data_name: product.createdAt
                updatedAt:
                    data_name: product.updatedAt
                type:
                    data_name: product.type
        columns:
            sku:
                label:         oro.product.sku.label
            productName:
                label:         oro.product.names.label
            inventoryStatusId:
                label:         oro.product.inventory_status.label
                frontend_type: select
                choices:       "@oro_entity_extend.enum_value_provider->getEnumChoicesByCode('prod_inventory_status')"
                translatable_options: false
            status:
                label:         oro.product.status.label
                frontend_type: select
                choices:       "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
            type:
                label:         oro.product.type.label
                frontend_type: select
                choices:       "@oro_product.provider.product_type_provider->getAvailableProductTypes"
                renderable:    false
            createdAt:
                label:         oro.ui.created_at
                frontend_type: datetime
            updatedAt:
                label:         oro.ui.updated_at
                frontend_type: datetime
        properties:
            id: ~
        sorters:
            columns:
                sku:
                    data_name: product.sku
                productName:
                    data_name: productName
                status:
                    data_name: product.status
                type:
                    data_name: product.type
                createdAt:
                    data_name: product.createdAt
                updatedAt:
                    data_name: product.updatedAt
            default:
                createdAt: DESC
        filters:
            columns:
                sku:
                    type:      string
                    data_name: product.skuUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                productName:
                    type:      string
                    data_name: productNameUppercase
                    case_insensitive: false
                    value_conversion: mb_strtoupper
                inventoryStatusId:
                    type:      enum
                    data_name: inventoryStatusId
                    enum_code: prod_inventory_status
                status:
                    data_name: product.status
                    type: choice
                    options:
                        field_options:
                            choices: "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
                type:
                    type: choice
                    data_name: product.type
                    options:
                        field_options:
                            choices: "@oro_product.provider.product_type_provider->getAvailableProductTypes"
                createdAt:
                    type:      datetime
                    data_name: product.createdAt
                updatedAt:
                    type:      datetime
                    data_name: product.updatedAt

    products-related-items-view:
        extends: products-related-items-base
        source:
            query:
                where:
                    and:
                        - 'product.id IN(:relatedItemsIds)'
            bind_parameters:
                -
                  name: relatedItemsIds
                  default: []

    products-related-products-view:
        extends: products-related-items-view

    products-upsell-products-view:
        extends: products-related-items-view

    products-related-items-edit:
        acl_resource: oro_product_update
        extends: products-related-items-base
        options:
            jsmodules:
                - orodatagrid/js/datagrid/listener/action-form-listener
                - oroproduct/js/app/datagrid/listener/related-product-listener
        source:
            query:
                where:
                    or:
                        - 'product.id IN (:relatedItemsIds) AND product.id NOT IN (:data_not_in)'
                        - '(product.id IN (:data_in)) AND product.id NOT IN (:data_not_in)'
            bind_parameters:
                -
                  name: relatedItemsIds
                  default: []
        actions:
            delete:
                type:          frontend
                label:         oro.grid.action.delete
                icon:          trash
                configuration:
                    triggerAction: excludeRow
#      @todo implement in scope of BB-10454
#        mass_actions:
#            delete:
#                type: frontend
#                label: oro.grid.action.delete
#                icon: trash
#                configuration:
#                    triggerAction: excludeRow

    products-related-products-edit:
        extends: products-related-items-edit
        options:
            rowSelection:
                dataField: id
                columnName: isRelated
                selectors:
                    included: '#productAppendRelated'
                    excluded: '#productRemoveRelated'

    products-upsell-products-edit:
        extends: products-related-items-edit
        options:
            rowSelection:
                dataField: id
                columnName: isRelated
                selectors:
                    included: '#productAppendUpsell'
                    excluded: '#productRemoveUpsell'

    products-related-items-select:
        extends: products-select-grid-base-without-default-sorting
        options:
            entityHint: oro.product.entity_plural_label
        source:
            query:
                select:
                    - >
                      (
                        CASE WHEN (product.id IN (:relatedItemsIds) OR product.id IN (:data_in)) AND product.id NOT IN (:data_not_in)
                        THEN true ELSE false END
                      ) as isRelated
                where:
                    and:
                        - product.id != :productId
            bind_parameters:
                - productId
                -
                  name: relatedItemsIds
                  default: []
        columns:
            isRelated:
                label: oro.product.is_related.label
                frontend_type: boolean
                editable: true
                order: -10
        filters:
            columns:
                isRelated:
                    data_name: isRelated
                    type:  boolean
        sorters:
            columns:
                isRelated:
                    data_name: isRelated
            default:
                isRelated: DESC

    products-related-products-select:
        extends: products-related-items-select
        options:
            rowSelection:
                dataField: id
                columnName: isRelated
                selectors:
                    included: '#productAppendRelatedSelect'
                    excluded: '#productRemoveRelatedSelect'

    products-upsell-products-select:
        extends: products-related-items-select
        options:
            rowSelection:
                dataField: id
                columnName: isRelated
                selectors:
                    included: '#productAppendUpsellSelect'
                    excluded: '#productRemoveUpsellSelect'

    frontend-product-search-grid:
        options:
            entityHint: oro.product.entity_plural_label
            displayOptions:
                selector: '.catalog__filter-controls__item_display-options'
            jsmodules:
                - oroproduct/js/app/datagrid/frontend-product-process-options-builder
                - oroproduct/js/app/datagrid/frontend-product-display-options-builder
                - oroproduct/js/app/datagrid/frontend-product-filters-events-dispatcher-builder
            frontend: true
        source:
            type: search
            search_index: website
            query:
                select:
                    - text.sku as sku
                    - integer.newArrival as newArrival
                    - text.names_LOCALIZATION_ID as name
                    - text.shortDescriptions_LOCALIZATION_ID as shortDescription
                    - text.type as type
                    - text.image_product_medium as image_product_medium
                    - text.image_product_large as image_product_large
                    - text.image_product_medium_webp as image_product_medium_webp
                    - text.image_product_large_webp as image_product_large_webp
                    - text.product_units as product_units
                    - text.primary_unit as unit
                    - integer.variant_fields_count as variant_fields_count
                    - text.schema_org_brand_name_LOCALIZATION_ID as schemaOrgBrandName
                    - text.schema_org_description_LOCALIZATION_ID as schemaOrgDescription
                from:
                    - oro_product_WEBSITE_ID
            hints:
                - {'name': HINT_SEARCH_TYPE, 'value': 'product_search'} # Used for search term logging.
        columns:
            sku:
                label:         oro.product.sku.label
            name:
                label:         oro.product.names.label
            shortDescription:
                label:         oro.product.short_descriptions.label
        filters:
            columns:
                all_text:
                    type:      string
                    data_name: all_text_LOCALIZATION_ID
                    label:     oro.product.anything.label
                    max_length: 255
                    options:
                        operator_choices:
                           '@oro_search.utils.search_all_text->getOperatorChoices'
        properties:
            id: ~
            type: ~
            schemaOrgBrandName: ~
            schemaOrgDescription: ~
            view_link:
                type:  url
                route: oro_product_frontend_product_view
                params: [ id ]
            newArrival: ~
            unit: ~
            view_aria_label:
                type:   translatable
                key:    oro.product.frontend.grid.action.product.view.aria_label
                params: [name]
        sorters:
            toolbar_sorting: true
            disable_default_sorting: true
        actions:
            view:
                type:          navigate
                label:         oro.grid.action.view
                ariaLabel:     view_aria_label
                link:          view_link
                icon:          eye
                rowAction:     true

    brand-grid:
        acl_resource: oro_product_brand_view
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Brand'
        source:
            type: orm
            query:
                select:
                    - brand.id
                    - brand.defaultTitle
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Brand', alias: brand }
        columns:
            defaultTitle:
                label: oro.product.brand.names.label
        properties:
            id: ~
            status:
                label:         oro.product.brand.names.label
                frontend_type: select
                choices:       "@oro_product.provider.brand_status_provider->getAvailableBrandStatuses"
            update_link:
                type:  url
                route: oro_product_brand_update
                params:
                    - id
            delete_link:
                type:  url
                route: oro_api_delete_brand
                params:
                    - id
        sorters:
            columns:
                defaultTitle:
                    data_name: brand.defaultTitle
        filters:
            columns:
                brandName:
                    label:     oro.product.brand.names.label
                    type:      string
                    data_name: brand.defaultTitle
        actions:
            update:
                acl_resource:  oro_product_brand_update
                type:          navigate
                label:         oro.grid.action.update
                link:          update_link
                icon:          edit
                rowAction:     true
            delete:
                acl_resource:  oro_product_brand_delete
                type:          delete
                label:         oro.grid.action.delete
                link:          delete_link
                icon:          trash
                rowAction:     true

    brand-select-grid:
        extended_entity_name: 'Oro\Bundle\ProductBundle\Entity\Brand'
        acl_resource: oro_product_brand_view
        options:
            entityHint: oro.product.brand.entity_plural_label
        source:
            type:         orm
            query:
                select:
                    - brand.id
                    - brand.defaultTitle
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Brand', alias: brand }
        columns:
            defaultTitle:
                label: oro.product.brand.label
        properties:
            id: ~
        sorters:
            columns:
                defaultTitle:
                    data_name: brand.defaultTitle
            default:
                defaultTitle: ASC
        filters:
            columns:
                defaultTitle:
                    type:      string
                    data_name: brand.defaultTitle

    attributes-grid:
        options:
            entityHint: oro.product.product_attributes.plural_label

    content-node-product-collection-widget-grid:
        source:
            type: orm
            query:
                select:
                    - product.id
                    - product.sku
                    - product.status
                    - product.type
                    - product.denormalizedDefaultName as productName
                    - IDENTITY(product.inventory_status) as inventoryStatusId
                from:
                    - { table: 'Oro\Bundle\ProductBundle\Entity\Product', alias: product }
                join:
                    left:
                        - { join: product.attributeFamily, alias: af }
        properties:
            id: ~
            product_family:
                type: localized_value
                data_name: af.labels
                allow_empty: true
        options:
            entityHint: oro.product.entity_plural_label
            entity_pagination: false
            toolbarOptions:
                hide: true
                pageSize:
                    items: [ 1000 ]
                    default_per_page: 1000
            jsmodules:
                - orodatagrid/js/sort-rows-drag-n-drop/builder
            gridBuildersOptions:
                sortRowsDragNDropBuilder:
                    sortOrderColumnName: 'categorySortOrder'
                    renderDropZonesMenu: true
                    renderDraggableSeparator: true
                    dropZones:
                        excludeFromCollection: 'oroproduct/js/sort-rows-drag-n-drop/exclude-from-collection'
        columns:
            categorySortOrder:
                order: -1
                label: oro.catalog.product.category_sort_order.label
                editable: false
                renderable: false
                manageable: false
                cellClassName: 'editing-cell'
                frontend_type: string
            sku:
                label: oro.product.sku.label
            productName:
                label: oro.product.names.label
            inventoryStatusId:
                label: oro.product.inventory_status.label
                frontend_type: select
                choices: "@oro_entity_extend.enum_value_provider->getEnumChoicesByCode('prod_inventory_status')"
                translatable_options: false
            status:
                label: oro.product.status.label
                frontend_type: select
                choices: "@oro_product.provider.product_status_provider->getAvailableProductStatuses"
            attributeFamily:
                label: oro.product.attribute_family.label
                data_name: product_family
            type:
                label: oro.product.type.label
                frontend_type: select
                choices: "@oro_product.provider.product_type_provider->getAvailableProductTypes"
                renderable: true
        sorters:
            columns:
                categorySortOrder:
                    data_name: categorySortOrder
            default:
                categorySortOrder: ASC

    kit-item-products-base-grid:
        extends: products-select-grid-base-without-default-sorting
        options:
            routerEnabled: false
            toolbarOptions:
                hide: true
                pagination:
                    onePage: true
        source:
            query:
                select:
                    - product_kit_item_product.sortOrder
                    - CONCAT_WS('|', primary_product_unit.code, GROUP_CONCAT(product_unit.code), GROUP_CONCAT(product_unit_precision.precision)) as unitsWithPrecision
                join:
                    inner:
                        - { join: product.unitPrecisions, alias: product_unit_precision }
                        - { join: product_unit_precision.unit, alias: product_unit }
                    left:
                        - { join: product.primaryUnitPrecision, alias: product_primary_unit_precision }
                        - { join: product_primary_unit_precision.unit, alias: primary_product_unit }
                        -
                            join: Oro\Bundle\ProductBundle\Entity\ProductKitItemProduct
                            alias: product_kit_item_product
                            conditionType: WITH
                            condition: "product_kit_item_product.kitItem = :kitItemId AND product_kit_item_product.product = product"
                where:
                    and:
                        - product_unit_precision.sell = true
                orderBy:
                    - column: product_kit_item_product.sortOrder
                      dir: ASC
                groupBy: product.id, product_kit_item_product.id, product_primary_unit_precision.id, primary_product_unit.code
            bind_parameters:
                kitItemId:
                    default: 0
        columns:
            type:
                renderable: false
            createdAt:
                renderable: false
            updatedAt:
                renderable: false
            unitOfQuantity:
                label: oro.product.productkititem.product_unit.label
                type: units_with_precision
                data_name: unitsWithPrecision
                frontend_type: html
                template: '@OroProduct/ProductKitItem/Datagrid/unitsWithPrecision.html.twig'

    kit-item-products-edit-grid:
        extends: kit-item-products-base-grid
        actions:
            remove:
                type: trigger-event
                event_name: kit-item-products-remove
                label: oro.product.grid.action.kit_item_products.remove
                icon: trash-o
        source:
            query:
                where:
                    and:
                        - product.id IN (:selectedProductsIds)
            bind_parameters:
                selectedProductsIds:
                    default: 0
        sorters:
            columns:
                sku:
                    disabled: true
                productName:
                    disabled: true
                status:
                    disabled: true
        properties:
            id: ~
        columns:
            sortOrder:
                order: -1
                label: oro.product.productkititemproduct.sort_order.label
                editable: true
                cellClassName: 'editing-cell'
                frontend_type: string
        options:
            requestMethod: POST
            jsmodules:
                - oroproduct/datagrid/builder/product-kit-items-builder
                - orodatagrid/js/sort-rows-drag-n-drop/builder
            gridBuildersOptions:
                sortRowsDragNDropBuilder:
                    highlightSortedItems: false
                    renderDropZonesMenu: true
            entity_pagination: false
            toolbarOptions:
                hide: true
                pageSize:
                    items: [ 100 ]
                    default_per_page: 100

    kit-item-products-add-grid:
        extends: kit-item-products-base-grid
        options:
            requestMethod: POST
            toolbarOptions:
                hide: false
                pagination:
                    onePage: false
        source:
            query:
                where:
                    and:
                        - product.id NOT IN (:selectedProductsIds)
            bind_parameters:
                selectedProductsIds:
                    default: 0

    kit-item-products-view-grid:
        extends: kit-item-products-base-grid
        source:
            query:
                where:
                    and:
                        - product_kit_item_product.id IS NOT NULL
        sorters:
            columns:
                sku:
                    disabled: true
                productName:
                    disabled: true
                status:
                    disabled: true
        properties:
            id: ~
            view_link:
                type: url
                route: oro_product_view
                params: [ id ]
        actions:
            view:
                type: navigate
                acl_resource: oro_product_view
                label: oro.grid.action.view
                icon: eye
                link: view_link
                launcherOptions:
                    className: 'no-hash hide'
                    attributes:
                        target: _blank
                rowAction: true
